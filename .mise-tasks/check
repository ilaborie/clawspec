#!/usr/bin/env bash
#MISE description="Run comprehensive pre-push checks: format, lint, and test"

set -eux

# Check formatting
cargo fmt --all --check

# Check without features
echo "=== Checking without features ==="
cargo clippy --all-targets -- -D warnings
cargo nextest run

# Check with all features
echo "=== Checking with all features ==="
cargo clippy --all-targets --all-features -- -D warnings
cargo nextest run --all-features
cargo test --doc --all-features

# Validate OpenAPI specifications
spectral lint examples/axum-example/doc/openapi.yml
